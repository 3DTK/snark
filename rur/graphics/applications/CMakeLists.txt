INCLUDE_DIRECTORIES(${QGLViewer_DIR})

SET( dir ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/ )

IF( BUILD_VIEW_POINTS_QT )
    SET( ViewPointsQt view-points )
    SET( LabelPointsQt label-points )
    IF( BUILD_VIEW_POINTS_QGLVIEWER )
        SET( ViewPointsQglviewer view-points-old )
        SET( LabelPointsQglviewer label-points-old )
    ENDIF( BUILD_VIEW_POINTS_QGLVIEWER )
ELSE( BUILD_VIEW_POINTS_QT )
    SET( ViewPointsQglviewer view-points )
    SET( LabelPointsQglviewer label-points )
ENDIF( BUILD_VIEW_POINTS_QT )

# This gets rid of an annoying conflict between windows macros and std::numeric_limits::max and min
IF(WIN32)
  ADD_DEFINITIONS(-DNOMINMAX)
ENDIF(WIN32)

IF( BUILD_VIEW_POINTS_QGLVIEWER )
    QT4_WRAP_CPP( LabelPointsMoc LabelPoints/MainWindow.h LabelPoints/Actions.h LabelPoints/Viewer.h LabelPoints/Tools.h LabelPoints/IdEdit.h OPTIONS -DBOOST_TT_HAS_OPERATOR_HPP_INCLUDED )
    QT4_ADD_RESOURCES( resources label-points.qrc )
    SOURCE_GROUP( "LabelPointsQtAutoGenerated" FILES ${LabelPointsMoc} )
    FILE( GLOB source ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/LabelPoints/*.cpp)
    FILE( GLOB include ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/LabelPoints/*.h)
    ADD_EXECUTABLE( ${LabelPointsQglviewer} label-points.cpp ${LabelPointsMoc} ${resources} ${source} ${include} )
    TARGET_LINK_LIBRARIES( ${LabelPointsQglviewer} ${QT_LIBRARIES} ArkGraphicsGL ${Ark_ALL_LIBRARIES} )
    SOURCE_GROUP( "LabelPoints" FILES label-points.cpp ${source} ${include} )


    QT4_WRAP_CPP( ViewPointsMoc ViewPoints/MainWindow.h ViewPoints/Action.h OPTIONS -DBOOST_TT_HAS_OPERATOR_HPP_INCLUDED )
    SOURCE_GROUP( "ViewPointsQtAutoGenerated" FILES ${ViewPointsMoc} )
    FILE( GLOB source ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/ViewPoints/*.cpp )
    FILE( GLOB include ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/ViewPoints/*.h )
    ADD_EXECUTABLE( ${ViewPointsQglviewer} view-points.cpp ${ViewPointsMoc} ${source} ${include} )
    TARGET_LINK_LIBRARIES( ${ViewPointsQglviewer} ${QT_LIBRARIES} ArkGraphicsGL ${Ark_ALL_LIBRARIES} ) #profiler )
    SOURCE_GROUP( "ViewPoints" FILES view-points.cpp ${source} ${include} )

    IF(WIN32)
        TARGET_LINK_LIBRARIES( ${LabelPointsQglviewer} ${QGLViewer_LIB} )
        TARGET_LINK_LIBRARIES( ${ViewPointsQglviewer} ${QGLViewer_LIB} )
    ELSE(WIN32)
        TARGET_LINK_LIBRARIES( ${LabelPointsQglviewer} glut ${QGLViewer_LIB} GL )
        TARGET_LINK_LIBRARIES( ${ViewPointsQglviewer} glut ${QGLViewer_LIB} GL )
        # it does not work, if qglviewer is installed with apt-get
        #TARGET_LINK_LIBRARIES( view-points glut qglviewer-qt4 )
    ENDIF(WIN32)

ENDIF( BUILD_VIEW_POINTS_QGLVIEWER )

IF( BUILD_VIEW_POINTS_QT )
    QT4_ADD_RESOURCES( resources label-points.qrc )
    QT4_WRAP_CPP( LabelPointsQtMoc LabelPointsQt/MainWindow.h LabelPointsQt/Actions.h LabelPointsQt/Viewer.h LabelPointsQt/Tools.h LabelPointsQt/IdEdit.h OPTIONS -DBOOST_TT_HAS_OPERATOR_HPP_INCLUDED )
    SOURCE_GROUP( "LabelPointsQtQtAutoGenerated" FILES ${LabelPointsQtMoc} )
    FILE( GLOB source ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/LabelPointsQt/*.cpp ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/ViewPointsQt/VertexBuffer.cpp)
    FILE( GLOB include ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/LabelPointsQt/*.h)
    ADD_EXECUTABLE( ${LabelPointsQt} label-points-qt.cpp ${LabelPointsQtMoc} ${resources} ${source} ${include} )
    SOURCE_GROUP( "LabelPointsQt" FILES label-points-qt.cpp ${source} ${include} )
    TARGET_LINK_LIBRARIES( ${LabelPointsQt} ArkGraphicsQt3D ${Ark_ALL_LIBRARIES} ${Qt3D_LIB} ${OPENGL_LIBRARY} )

    QT4_WRAP_CPP( ViewPointsQtMoc ViewPointsQt/MainWindow.h ViewPointsQt/Viewer.h ViewPointsQt/Action.h OPTIONS -DBOOST_TT_HAS_OPERATOR_HPP_INCLUDED )
    SOURCE_GROUP( "ViewPointsQtQtAutoGenerated" FILES ${ViewPointsQtMoc} )
    FILE( GLOB source ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/ViewPointsQt/*.cpp )
    FILE( GLOB include ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/ViewPointsQt/*.h )
    SOURCE_GROUP( "ViewPointsQt" FILES view-points-qt.cpp ${source} ${include} )
    ADD_EXECUTABLE( ${ViewPointsQt} view-points-qt.cpp  ${source} ${include} ${ViewPointsQtMoc} )
    TARGET_LINK_LIBRARIES( ${ViewPointsQt} ${QT_LIBRARIES} ${Qt3D_LIB} ArkGraphicsQt3D ${Ark_ALL_LIBRARIES} ${OPENGL_LIBRARY} ) #profiler )
ENDIF( BUILD_VIEW_POINTS_QT )

# it does not build on windows for a minuscule reason; fix, when we have time
IF( WIN32 )
SOURCE_GROUP( "src" FILES view-points.cpp )
ELSE( WIN32 )
QT4_WRAP_CPP( ViewSceneMoc ViewScene/MainWindow.h ViewScene/Scene.h OPTIONS -DBOOST_TT_HAS_OPERATOR_HPP_INCLUDED )
SOURCE_GROUP( "ViewSceneQtAutoGenerated" FILES ${ViewSceneMoc} )
FILE( GLOB source ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/ViewScene/*.cpp)
FILE( GLOB include ${Graphics_SOURCE_CODE_BASE_DIR}/Applications/ViewScene/*.h)
ENDIF( WIN32 )

IF( WIN32 )
INSTALL( TARGETS ${LabelPointsQglviewer}  ${ViewPointsQglviewer} ${ViewPointsQt} ${LabelPointsQt}
         RUNTIME DESTINATION ${CMAKE_INSTALL_PREFIX}/${Ark_INSTALL_BIN_DIR}
         COMPONENT Runtime )
ELSE( WIN32 )
INSTALL( TARGETS ${LabelPointsQglviewer}  ${ViewPointsQglviewer} ${ViewPointsQt} ${LabelPointsQt}
         RUNTIME DESTINATION ${CMAKE_INSTALL_PREFIX}/${Ark_INSTALL_BIN_DIR}
         COMPONENT Runtime )
ENDIF( WIN32 )
                 
